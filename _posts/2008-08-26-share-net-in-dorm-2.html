---
layout: post
title: share net in dorm
date: 2008-08-26 17:07:00.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- System
tags: []
meta:
  blogger_author: yangyilong
  blogger_5db691c6560366c0233000029746f2a2_permalink: '1271200801011350815'
  blogger_blog: everydaydreamy.blogspot.com
author:
  login: mcloud
  email: ''
  display_name: mcloud
  first_name: ''
  last_name: ''
---
<p>今天终于实现了宿舍的教育网透明上公网和共享上网,跟大家分享</p>
<p>配置:</p>
<p>1. 一台squid服务器(公网教育网)</p>
<p>2.一台本地的服务器支持nat,我用的vmware虚拟一台rhel,  eth0 外网卡，eth1内网卡</p>
<p>3.在squid服务器安装squid:  acl allow yourip, http_port 3128 transparen(关键)</p>
<p>4. 本地服务器上 iptables -t nat -A POSTROUTING -o eth0  -j MASQUERADE</p>
<p>iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j DNAT --to-dest squid-server-ip:port</p>
<p>5. 在本地服务器上配置dncp: gateway localserver  DNS:dns-server</p>
<p>6.平时你打开本地服务器上教育网，用户只要接入你所在的局域网，就可以上公网了，速度挺快，要使用ftp, 请也转发21 20 端口
<div class="blogger-post-footer"><img width="1" height="1" src="{{ site.baseurl }}/assets/" alt="" /></div>
