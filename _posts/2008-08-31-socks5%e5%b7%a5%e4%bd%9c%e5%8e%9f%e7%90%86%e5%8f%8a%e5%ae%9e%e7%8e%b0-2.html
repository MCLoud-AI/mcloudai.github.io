---
layout: post
title: SOCKS5工作原理及实现
date: 2008-08-31 05:29:00.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- System
tags: []
meta:
  blogger_blog: everydaydreamy.blogspot.com
  blogger_author: yangyilong
  blogger_5db691c6560366c0233000029746f2a2_permalink: '1370860696126904000'
author:
  login: mcloud
  email: ''
  display_name: mcloud
  first_name: ''
  last_name: ''
---
<p><strong>sock5代理的工作程序</strong></p>
<p>1.需要向代理方服务器发出请求信息。<br />2.代理方应答<br />3.需要代理方接到应答后发送向代理方发送目的ip和端口<br />4.代理方与目的连接<br />5.代理方将需要代理方发出的信息传到目的方，将目的方发出的信息传到需要代理方。代理完成。</p>
<p>由于网上的信息传输都是运用tcp或udp进行的，所以使用socks5代理可以办到网上所能办到的一切，而且不舆目的方会查到你的ip,既安全又方<br />便 sock5支持UDP和TCP,但两种代理是有区别的，以下分类说明</p>
<p><strong>如何用代理TCP协议</strong></p>
<p>1.向服务器的1080端口建立tcp连接。<br />2.向服务器发送 05 01 00 （此为16进制码，以下同）<br />3.如果接到 05 00 则是可以代理<br />4.发送 05 01 00 01 + 目的地址(4字节） + 目的端口（2字节），目的地址和端口都是16进制码（不是字符串！！）。 例202.103.190.27 -<br />7201 则发送的信息为：05 01 00 01 CA 67 BE 1B 1C 21 (CA=202 67=103 BE=190 1B=27 1C21=7201)<br />5.接受服务器返回的自身地址和端口，连接完成<br />6.以后操作和直接与目的方进行TCP连接相同。</p>
<p><strong>如何用代理UDP连接</strong></p>
<p>1.向服务器的1080端口建立udp连接<br />2.向服务器发送 05 01 00<br />3.如果接到 05 00 则是可以代理<br />4.发送 05 03 00 01 00 00 00 00 + 本地UDP端口（2字节）<br />5.服务器返回 05 00 00 01 +服务器地址+端口<br />6.需要申请方发送 00 00 00 01 +目的地址IP（4字节）+目的端口 +所要发送的信息<br />7.当有数据报返回时 向需要代理方发出00 00 00 01 +来源地址IP（4字节）+来源端口 +接受的信息</p>
<p>实现：</p>
<p>1.安装socks5的rpm包  http://ftp.surpasslab.com上有</p>
<p>2.运行socks5 -b  端口 -t</p>
<p>3.把socks5 -b 端口 -t加入rc.local开机启动</p>
<p>4.用户端程序就可以访问了
<div class="blogger-post-footer"><img width="1" height="1" src="{{ site.baseurl }}/assets/" alt="" /></div>
