---
layout: post
title: Write predicate for DLV
date: 2012-11-14 23:57:12.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags:
- asp
- c++
- dlv
meta:
  _publicize_pending: '1'
author:
  login: mcloud
  email: ''
  display_name: mcloud
  first_name: ''
  last_name: ''
---
<p>1. using MinGW/ MSYS   (must be in C:/  change gcc to 4.5.0)</p>
<p>2.  download DLV for windows  (if using standard c++  &lt;xxx&gt; adding using namespace std;  iii must exits)</p>
<blockquote><p><span style="color:#008000;">#include "extpred.h"</span><br />
<span style="color:#008000;">#include "stdlib.h"</span><br />
<span style="color:#008000;">#include "stdio.h"</span></p>
<p><span style="color:#008000;">#ifdef __cplusplus</span><br />
<span style="color:#008000;">extern "C" {</span><br />
<span style="color:#008000;">#endif</span></p>
<p><span style="color:#008000;">BUILTIN(mean,iii) //base oracle</span><br />
<span style="color:#008000;">{</span><br />
<span style="color:#008000;"> return true;</span><br />
<span style="color:#008000;">}</span><br />
<span style="color:#008000;">BUILTIN(mean,iio) //one, two, result</span><br />
<span style="color:#008000;">{</span><br />
<span style="color:#008000;"> if( argv[0].isString() &amp;&amp; argv[1].isString())</span><br />
<span style="color:#008000;"> {</span><br />
<span style="color:#008000;"> double result = atof(argv[0].toString()) + atof(argv[1].toString()) / 2;</span><br />
<span style="color:#008000;"> char r[20];</span><br />
<span style="color:#008000;"> sprintf(r, "%.2f", result);</span><br />
<span style="color:#008000;"> argv[2] = CONSTANT(r, true);</span><br />
<span style="color:#008000;"> return true;</span><br />
<span style="color:#008000;"> }</span><br />
<span style="color:#008000;"> return false;</span><br />
<span style="color:#008000;">}</span><br />
<span style="color:#008000;">#ifdef __cplusplus</span><br />
<span style="color:#008000;">}</span><br />
<span style="color:#008000;">#endif</span></p></blockquote>
<p>3. write c++ for DLV</p>
<p>4. compile / install / using</p>
<p>dlvlib create xxx</p>
<p>dlvlib install xxx</p>
<p>using your predicate in dlv #xxxx</p>
<p>tips:</p>
<p>1.         const char * to int / long / double:  atoi/ atol / atof</p>
<p>2.        int / long / double to const char *: sprintf(const char *, "format", int/long/double)</p>
<p>3.        libtool : generate shared library (all os)</p>
<p>libtool --mode = compile g++ -g(debug information) -O(optimize) -c outfile  :  generate  .o .lo(link object file)</p>
<p>libtool --model = link -no-undefined(generate .dll or .so)  -avoid-version -module(dlopen file) -g -O -o .la .lo extpred.lo(to assemble) -rpath   /usr/local/lib -lm (destination)</p>
<p>libtool --model= install cp .dll/la/.so path</p>
<p>libtool --model=clean rm -rf xxxx</p>
<p>4.    symbolic(name whole Frist not number) / string  (number can edit) /int</p>
