---
layout: post
title: freebsd + nat
date: 2011-09-14 21:36:27.000000000 +08:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Unix/Linux
tags:
- freebsd
- nat
- unix
meta: {}
author:
  login: mcloud
  email: ''
  display_name: mcloud
  first_name: ''
  last_name: ''
---
<p>Using the firewall have three way in freebsd: ipfilter, ipfirewall, pack filter</p>
<p>I`d like use ipfilter. </p>
<p>1. edit rc.conf<br />
ipfilter_enable="YES"<br />
ipfilter_rules="/etc/ipf.rules"<br />
ipmon_enable="YES"    # this is the moniter<br />
ipmon_flags="-Ds"  #D is running as a deamon, S save using syslog</p>
<p>gateway_enable="YES"    # use 802.1q protocol / not the 802.3<br />
ipnat_enable="YES"<br />
ipnat_rules="/etc/ipnat.rules" </p>
<p>2. edit ipnat.rules<br />
map rl1 192.168.1.0/24 -&gt; 0/32 portmap tcp/udp auto  #rl1 is the output interfaces  0/32 is using the dymanic ip</p>
<p>3. edit ipf.rules<br />
pass out all<br />
pass in all</p>
<p>4. testing<br />
4.1 ipnat<br />
-CF clean all rules<br />
-l load the rule file<br />
4.2 ipf<br />
-Fa clean all rules<br />
-f load the rule file </p>
